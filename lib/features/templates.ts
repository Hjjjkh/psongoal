/**
 * 目标创建模板定义
 * 仅用于目标创建功能，提供 3 类固定模板：健身、学习、项目
 * 
 * 模板结构：
 * - 每个模板包含多个 Phase（名称和描述）
 * - 每个 Phase 包含示例 Action（title 模板、definition、estimated_time）
 * - Action 使用 {n} 占位符，支持批量生成
 * - 支持多阶段渐进式目标设计
 */

export type TemplateCategory = 'health' | 'learning' | 'project'

export interface TemplateAction {
  titleTemplate: string  // 例如："核心训练 Day {n}"
  definition: string     // 完成标准
  estimatedTime: number | null  // 预计时间（分钟）
  tags?: string[]       // 标签（仅用于预览显示，不保存到数据库）
  priority?: 'low' | 'medium' | 'high'  // 优先级（仅用于预览显示，不保存到数据库）
}

export interface TemplatePhase {
  name: string
  description: string | null  // 支持 Markdown 格式
  exampleActions: TemplateAction[]
}

export interface GoalTemplate {
  category: TemplateCategory
  phases: TemplatePhase[]  // 改为多阶段数组
  // 保持向后兼容：如果只有 phases，phase 取第一个
  phase?: TemplatePhase  // 兼容旧代码
}

/**
 * 目标创建模板定义
 * 仅用于目标创建，每个类别包含多阶段渐进式模板
 */
export const GOAL_TEMPLATES: Record<TemplateCategory, GoalTemplate> = {
  health: {
    category: 'health',
    phases: [
      {
        name: '基础适应期（第1-2周）',
        description: '建立健身习惯，掌握基础动作\n\n**阶段目标：**\n- 建立规律的运动习惯（每周3-4次）\n- 掌握基础动作标准，避免运动损伤\n- 适应运动强度，培养运动兴趣\n- 建立运动记录和反馈机制\n\n**训练原则：**\n- 动作质量 > 数量，强度适中\n- 循序渐进，不急于求成\n- 充分热身和拉伸\n- 注重身体感受和恢复',
        exampleActions: [
          {
            titleTemplate: '全身激活训练 Day {n}',
            definition: '完成全身激活训练：5分钟动态热身（关节活动、轻度有氧）+ 平板支撑2组（每组30秒，组间休息30秒）+ 标准深蹲2组（每组10次，动作标准）+ 俯卧撑2组（每组5-10次，可跪姿）+ 5分钟静态拉伸（重点：肩颈、腰背、腿部）。全程关注动作标准，感受肌肉发力，如有不适立即停止。',
            estimatedTime: 25,
            tags: ['基础', '力量', '激活'],
            priority: 'high',
          },
          {
            titleTemplate: '有氧入门 Day {n}',
            definition: '完成有氧运动：5分钟热身（快走或慢跑）+ 20分钟主运动（快走、慢跑或骑行，保持轻松强度，能正常说话的程度）+ 5分钟拉伸放松。总时长30分钟，心率控制在最大心率的50-60%（约110-130次/分钟）。记录运动感受和心率数据。',
            estimatedTime: 30,
            tags: ['有氧', '入门', '心肺'],
            priority: 'high',
          },
          {
            titleTemplate: '柔韧性基础 Day {n}',
            definition: '进行柔韧性训练：5分钟轻度热身 + 15分钟全身拉伸（每个动作保持15-20秒，深呼吸配合）。重点拉伸：肩颈（颈部转动、肩部拉伸）、腰背（猫式伸展、脊柱扭转）、腿部（大腿前后侧、小腿、髋部）。感受拉伸感而非疼痛，保持自然呼吸。',
            estimatedTime: 20,
            tags: ['柔韧性', '拉伸', '恢复'],
            priority: 'medium',
          },
          {
            titleTemplate: '恢复日 Day {n}',
            definition: '进行主动恢复：10分钟轻松散步（心率不超过100次/分钟）+ 10分钟全身拉伸（重点放松前一天训练的肌群）+ 5分钟冥想或深呼吸。评估身体状态，记录恢复感受，为下一轮训练做准备。如有明显疲劳或不适，延长恢复时间。',
            estimatedTime: 25,
            tags: ['恢复', '放松', '评估'],
            priority: 'low',
          },
          {
            titleTemplate: '基础力量循环 Day {n}',
            definition: '完成基础力量循环训练：3轮循环，每轮包含：深蹲10次 + 俯卧撑5-8次 + 平板支撑30秒 + 休息60秒。动作标准优先，不追求速度。完成后进行5分钟拉伸。记录完成情况和身体感受。',
            estimatedTime: 20,
            tags: ['力量', '循环', '基础'],
            priority: 'high',
          },
        ],
      },
      {
        name: '能力提升期（第3-6周）',
        description: '提升训练强度，多样化训练方式\n\n**阶段目标：**\n- 逐步增加训练强度和时长（每周4-5次）\n- 引入更多训练方式和动作变化\n- 提升力量、耐力、柔韧性等身体素质\n- 建立稳定的训练节奏和恢复机制\n\n**训练重点：**\n- 在保持动作标准的基础上，逐步提升强度和难度\n- 引入渐进式超负荷原则\n- 注重训练多样性和趣味性\n- 建立训练日志，追踪进步',
        exampleActions: [
          {
            titleTemplate: '核心力量训练 Day {n}',
            definition: '完成核心力量训练：5分钟动态热身 + 平板支撑3组（每组60秒，组间休息45秒）+ 仰卧起坐3组（每组15次，动作标准）+ 侧平板支撑3组（每侧30秒，左右交替）+ 俄罗斯转体3组（每组20次）+ 5分钟拉伸。注重动作质量，感受核心肌群全程发力，记录完成情况。',
            estimatedTime: 35,
            tags: ['核心', '力量', '稳定'],
            priority: 'high',
          },
          {
            titleTemplate: '有氧耐力训练 Day {n}',
            definition: '完成有氧耐力训练：5分钟热身（动态拉伸、轻度有氧）+ 30分钟主运动（慢跑、快走、骑行或游泳，保持中等强度，能说短句的程度）+ 5分钟拉伸放松。心率控制在最大心率的60-70%（约130-150次/分钟）。记录运动距离、时长、心率区间和身体感受。',
            estimatedTime: 40,
            tags: ['有氧', '耐力', '心肺'],
            priority: 'high',
          },
          {
            titleTemplate: '上肢力量训练 Day {n}',
            definition: '完成上肢力量训练：5分钟热身 + 俯卧撑3组（每组10-15次，标准或进阶变式）+ 哑铃训练3组（肩推、侧平举、弯举，每组10-12次）或引体向上3组（每组5-10次，可辅助）+ 5分钟拉伸。根据自身能力选择重量和次数，注重动作标准，记录训练数据。',
            estimatedTime: 35,
            tags: ['力量', '上肢', '增肌'],
            priority: 'high',
          },
          {
            titleTemplate: '下肢力量训练 Day {n}',
            definition: '完成下肢力量训练：5分钟热身 + 深蹲3组（每组15次，可负重）+ 箭步蹲3组（每侧10次，前后交替）+ 小腿提踵3组（每组20次）+ 单腿臀桥3组（每侧10次）+ 5分钟拉伸。保持正确姿势，感受腿部肌肉全程发力，记录完成情况和身体感受。',
            estimatedTime: 35,
            tags: ['力量', '下肢', '稳定'],
            priority: 'high',
          },
          {
            titleTemplate: '柔韧性训练 Day {n}',
            definition: '进行柔韧性训练：5分钟轻度热身 + 20分钟全身拉伸（每个动作保持20-30秒，深呼吸配合）。重点拉伸：肩颈（颈部各方向拉伸、肩部环绕）、腰背（猫式、下犬式、脊柱扭转）、腿部（大腿前后侧、小腿、髋部开合）、髋部（鸽子式、蝴蝶式）。感受拉伸感，保持自然呼吸，记录柔韧性改善情况。',
            estimatedTime: 25,
            tags: ['柔韧性', '拉伸', '恢复'],
            priority: 'medium',
          },
          {
            titleTemplate: 'HIIT训练 Day {n}',
            definition: '完成高强度间歇训练：5分钟热身 + 4轮HIIT（每轮：高强度运动30秒 + 休息60秒，可选择：开合跳、高抬腿、波比跳、登山者等）+ 5分钟拉伸。根据能力调整强度和轮数，记录完成情况和心率变化。',
            estimatedTime: 20,
            tags: ['HIIT', '心肺', '燃脂'],
            priority: 'medium',
          },
        ],
      },
      {
        name: '巩固优化期（第7周+）',
        description: '个性化调整，保持长期习惯\n\n**阶段目标：**\n- 根据个人情况和目标优化训练计划（每周5-6次）\n- 保持训练强度和频率，形成可持续习惯\n- 持续提升和突破，设定新挑战\n- 建立完整的训练体系和生活习惯\n\n**训练重点：**\n- 个性化调整，针对个人目标（增肌/减脂/提升柔韧性/提升耐力等）\n- 保持训练多样性，避免平台期\n- 注重恢复和营养，形成完整体系\n- 定期评估和调整，保持长期动力',
        exampleActions: [
          {
            titleTemplate: '综合力量训练 Day {n}',
            definition: '完成综合力量训练：5分钟动态热身 + 复合动作训练（深蹲推举、硬拉、划船等，3-4组，每组8-12次）+ 孤立动作训练（针对薄弱肌群，2-3组，每组10-15次）+ 核心稳定训练（3组，每组30-60秒）+ 5分钟拉伸。根据个人目标调整重量和次数，记录训练数据和身体感受，定期评估进步。',
            estimatedTime: 50,
            tags: ['综合', '力量', '复合'],
            priority: 'high',
          },
          {
            titleTemplate: '有氧进阶训练 Day {n}',
            definition: '完成有氧进阶训练：5分钟热身 + 35-40分钟主运动（可选择：长距离慢跑、间歇跑、变速跑、游泳、骑行等）。根据目标调整强度：减脂（心率60-70%）、提升耐力（心率70-80%）、提升速度（间歇训练）。记录距离、时长、心率、配速等数据，追踪进步。',
            estimatedTime: 50,
            tags: ['有氧', '进阶', '耐力'],
            priority: 'high',
          },
          {
            titleTemplate: '专项训练 Day {n}',
            definition: '进行专项训练：根据个人目标选择重点训练内容。增肌：大重量低次数（3-5组，每组6-8次）；减脂：中高强度有氧+力量（30分钟有氧+20分钟力量）；提升柔韧性：深度拉伸+瑜伽/普拉提（40分钟）；提升爆发力：爆发力训练+敏捷训练（30分钟）。记录训练内容和效果，定期调整。',
            estimatedTime: 40,
            tags: ['专项', '优化', '个性化'],
            priority: 'high',
          },
          {
            titleTemplate: '恢复与评估 Day {n}',
            definition: '进行恢复和评估：15分钟轻松活动（散步、轻度拉伸）+ 15分钟深度拉伸（重点放松训练肌群，每个动作30-60秒）+ 10分钟冥想或深呼吸。评估本周训练效果：记录身体感受、进步情况、遇到的问题。调整下周训练计划，设定新目标。如有疲劳或不适，延长恢复时间。',
            estimatedTime: 40,
            tags: ['恢复', '评估', '调整'],
            priority: 'medium',
          },
          {
            titleTemplate: '功能性训练 Day {n}',
            definition: '完成功能性训练：5分钟热身 + 功能性动作训练（单腿深蹲、土耳其起立、农夫行走、推拉训练等，3-4组，每组8-12次）+ 平衡和协调训练（3组，每组30秒）+ 5分钟拉伸。提升日常活动能力和运动表现，记录完成情况和身体感受。',
            estimatedTime: 40,
            tags: ['功能性', '平衡', '协调'],
            priority: 'medium',
          },
        ],
      },
    ],
    // 向后兼容：取第一个阶段
    phase: undefined as any,
  },
  learning: {
    category: 'learning',
    phases: [
      {
        name: '基础入门期（第1-3周）',
        description: '建立学习框架，掌握基础知识\n\n**阶段目标：**\n- 建立规律的学习习惯（每天1-2小时，每周5-6天）\n- 掌握基础知识框架和核心概念\n- 建立有效的学习方法和笔记系统\n- 培养学习兴趣和信心，克服畏难情绪\n\n**学习原则：**\n- 理解 > 记忆，建立知识框架\n- 主动学习，多思考多提问\n- 及时复习，遵循遗忘曲线\n- 理论结合实践，加深理解',
        exampleActions: [
          {
            titleTemplate: '新知识学习 Day {n}',
            definition: '学习新内容1小时：选择合适的学习材料（教材、视频课程、音频等），采用主动学习法。学习过程：预习（5分钟，了解大纲）→ 学习（40分钟，做笔记、提问、思考）→ 总结（15分钟，记录关键概念、重要观点、疑问和思考）。使用康奈尔笔记法或思维导图，记录学习进度和难点。',
            estimatedTime: 60,
            tags: ['学习', '新知识', '理解'],
            priority: 'high',
          },
          {
            titleTemplate: '知识整理 Day {n}',
            definition: '整理和总结知识30分钟：将当天学习的内容进行系统化整理。制作思维导图（展示知识结构和关系）+ 写总结笔记（提炼核心要点和关键概念）+ 制作知识卡片（记录重要定义、公式、案例）。建立知识索引，方便后续查找和复习。',
            estimatedTime: 30,
            tags: ['整理', '总结', '系统化'],
            priority: 'high',
          },
          {
            titleTemplate: '基础复习 Day {n}',
            definition: '复习已学内容30分钟：使用主动回忆法复习前2-3天的学习内容。步骤：不看笔记回忆内容（15分钟，尝试用自己的话解释概念）→ 对照笔记查漏补缺（10分钟，标记遗忘和模糊的内容）→ 完成基础练习题（5分钟，检验理解程度）。记录复习效果和需要加强的内容。',
            estimatedTime: 30,
            tags: ['复习', '巩固', '回忆'],
            priority: 'high',
          },
          {
            titleTemplate: '拓展阅读 Day {n}',
            definition: '进行拓展学习20分钟：阅读相关文章、观看补充资料或探索相关主题。目标：拓宽知识面、加深理解、发现兴趣点。记录：新观点、相关案例、疑问和思考。建立知识网络，将新知识与已有知识建立联系。',
            estimatedTime: 20,
            tags: ['拓展', '阅读', '网络'],
            priority: 'medium',
          },
          {
            titleTemplate: '学习复盘 Day {n}',
            definition: '进行学习复盘15分钟：回顾本周学习情况。记录：学习进度、掌握程度、遇到的困难、学习方法效果。评估：哪些方法有效、哪些需要改进、下周学习重点。调整学习计划，优化学习方法。',
            estimatedTime: 15,
            tags: ['复盘', '评估', '优化'],
            priority: 'medium',
          },
        ],
      },
      {
        name: '深入学习期（第4-8周）',
        description: '深入理解，实践应用\n\n**阶段目标：**\n- 深入理解核心概念、原理和机制（每天1.5-2小时）\n- 将理论与实践相结合，解决实际问题\n- 提升分析、综合和解决问题的能力\n- 建立完整的知识体系和思维框架\n\n**学习重点：**\n- 深度理解，多角度思考\n- 实践应用，理论联系实际\n- 知识整合，建立知识网络\n- 问题解决，提升应用能力',
        exampleActions: [
          {
            titleTemplate: '深入学习 Day {n}',
            definition: '深入学习核心内容1.5小时：选择重点和难点内容进行深度学习。采用费曼学习法：尝试用自己的话解释概念（20分钟）→ 找出解释不清的地方（10分钟）→ 重新学习并简化（30分钟）→ 再次解释并完善（20分钟）→ 记录深度思考和疑问（10分钟）。建立概念之间的深层联系，理解原理和机制。',
            estimatedTime: 90,
            tags: ['学习', '深入', '理解'],
            priority: 'high',
          },
          {
            titleTemplate: '实践应用 Day {n}',
            definition: '将所学知识应用到实际1小时：完成一个实践项目、解决实际问题或进行案例分析。步骤：分析问题（15分钟，明确问题本质和所需知识）→ 设计方案（20分钟，运用所学知识设计解决方案）→ 执行实践（20分钟，动手实践或案例分析）→ 总结反思（5分钟，记录实践中的发现、问题和改进）。通过实践加深理解，发现知识盲点和应用场景。',
            estimatedTime: 60,
            tags: ['实践', '应用', '问题解决'],
            priority: 'high',
          },
          {
            titleTemplate: '知识复习 Day {n}',
            definition: '复习已学内容45分钟：使用间隔重复法复习前3-5天的学习内容。步骤：主动回忆（20分钟，不看笔记回忆，尝试解释和举例）→ 对照笔记查漏补缺（15分钟，标记遗忘和模糊的内容，重点复习）→ 完成相关练习题（10分钟，检验理解程度和应用能力）。记录复习效果，调整复习频率。',
            estimatedTime: 45,
            tags: ['复习', '巩固', '间隔重复'],
            priority: 'high',
          },
          {
            titleTemplate: '测试练习 Day {n}',
            definition: '进行测试和练习45分钟：完成练习题、模拟测试或自测。步骤：完成测试（30分钟，模拟真实考试环境，限时完成）→ 分析错题（10分钟，找出错误原因：概念不清、理解偏差、应用错误等）→ 针对性改进（5分钟，制定改进计划，加强薄弱环节）。检验学习效果，发现薄弱环节，针对性改进。',
            estimatedTime: 45,
            tags: ['测试', '练习', '检验'],
            priority: 'high',
          },
          {
            titleTemplate: '知识整合 Day {n}',
            definition: '整合和系统化知识40分钟：将不同知识点联系起来，形成知识体系。制作综合思维导图（展示知识结构和关系，15分钟）+ 写系统总结（提炼核心要点和关键联系，15分钟）+ 建立知识网络（记录知识点之间的关联和应用场景，10分钟）。形成完整的知识框架，提升综合理解能力。',
            estimatedTime: 40,
            tags: ['整合', '系统', '网络'],
            priority: 'medium',
          },
          {
            titleTemplate: '讨论交流 Day {n}',
            definition: '进行讨论和交流30分钟：与同学、老师或社区讨论学习内容。可以：分享学习心得、讨论疑难问题、解释概念给他人、参与学习小组。通过讨论加深理解，发现不同视角，提升表达能力。记录讨论中的新观点和启发。',
            estimatedTime: 30,
            tags: ['讨论', '交流', '协作'],
            priority: 'medium',
          },
        ],
      },
      {
        name: '巩固提升期（第9周+）',
        description: '综合运用，查漏补缺\n\n**阶段目标：**\n- 综合运用所学知识解决复杂问题（每天1.5-2小时）\n- 查漏补缺，完善知识体系，确保没有盲点\n- 提升应用、创新和迁移能力\n- 形成长期学习习惯和自主学习能力\n\n**学习重点：**\n- 综合应用，解决复杂问题\n- 查漏补缺，完善知识体系\n- 拓展提升，探索前沿知识\n- 持续优化，保持学习动力',
        exampleActions: [
          {
            titleTemplate: '综合应用 Day {n}',
            definition: '综合应用所学知识1.5小时：完成综合项目、解决复杂问题或进行创新实践。步骤：分析问题（20分钟，明确问题本质、所需知识和约束条件）→ 设计方案（30分钟，综合运用多个知识点设计解决方案）→ 执行实践（30分钟，动手实践或深入分析）→ 总结反思（10分钟，记录实践中的发现、问题和改进，评估知识应用效果）。将多个知识点结合起来，提升综合应用能力。',
            estimatedTime: 90,
            tags: ['综合', '应用', '问题解决'],
            priority: 'high',
          },
          {
            titleTemplate: '查漏补缺 Day {n}',
            definition: '查漏补缺和强化1小时：针对薄弱环节进行专项学习。步骤：识别薄弱点（10分钟，通过测试、实践或复习发现）→ 专项学习（30分钟，深入学习薄弱内容，采用多种学习方法）→ 针对性练习（15分钟，完成相关练习题，检验掌握程度）→ 评估改进（5分钟，记录改进效果，调整学习计划）。完善知识体系，确保没有遗漏。',
            estimatedTime: 60,
            tags: ['查漏', '强化', '专项'],
            priority: 'high',
          },
          {
            titleTemplate: '系统复习 Day {n}',
            definition: '系统复习和回顾1小时：全面回顾已学内容，使用多种复习方法。步骤：主动回忆（30分钟，不看笔记回忆，尝试解释和举例）→ 知识测试（15分钟，完成综合测试，检验掌握程度）→ 讲解复述（10分钟，尝试向他人讲解或录音讲解，检验理解深度）→ 总结评估（5分钟，记录复习效果，识别需要加强的内容）。巩固整体知识体系，提升长期记忆。',
            estimatedTime: 60,
            tags: ['复习', '系统', '巩固'],
            priority: 'high',
          },
          {
            titleTemplate: '拓展提升 Day {n}',
            definition: '拓展和提升45分钟：学习进阶内容、探索前沿知识或进行深入研究。可以：阅读前沿论文、学习高级主题、探索相关领域、参与专业社区讨论。目标：拓宽知识边界、了解最新发展、发现新的学习方向。记录：新观点、前沿知识、启发和思考。持续提升，保持学习动力。',
            estimatedTime: 45,
            tags: ['拓展', '提升', '前沿'],
            priority: 'medium',
          },
          {
            titleTemplate: '知识迁移 Day {n}',
            definition: '进行知识迁移练习45分钟：将所学知识应用到新领域或新问题。步骤：选择新场景（10分钟，选择与已学知识相关但不同的应用场景）→ 分析联系（15分钟，分析新旧场景的相似性和差异性）→ 迁移应用（15分钟，尝试将知识迁移到新场景，解决新问题）→ 总结反思（5分钟，记录迁移效果和发现）。提升知识迁移能力，增强学习效果。',
            estimatedTime: 45,
            tags: ['迁移', '应用', '创新'],
            priority: 'medium',
          },
        ],
      },
    ],
    // 向后兼容：取第一个阶段
    phase: undefined as any,
  },
  project: {
    category: 'project',
    phases: [
      {
        name: '规划准备期（第1-2周）',
        description: '明确需求，设计架构，准备开发\n\n**阶段目标：**\n- 深入理解项目目标和用户需求\n- 完成系统设计和架构规划\n- 准备开发环境和工具链\n- 制定详细开发计划和里程碑\n\n**工作重点：**\n- 需求分析：用户调研、需求梳理、功能定义\n- 架构设计：系统架构、数据库设计、接口设计\n- 技术选型：技术栈选择、工具配置、规范制定\n- 开发准备：环境搭建、项目初始化、团队协作',
        exampleActions: [
          {
            titleTemplate: '需求分析 Day {n}',
            definition: '进行需求分析和设计1小时：深入分析用户需求，明确功能边界和优先级。步骤：用户调研（20分钟，访谈、问卷或数据分析）→ 需求梳理（20分钟，整理功能列表、用户故事、优先级）→ 功能设计（15分钟，设计功能方案、用户流程、交互逻辑）→ 原型设计（5分钟，绘制流程图、原型图或线框图）。输出：需求文档、功能列表、原型图。',
            estimatedTime: 60,
            tags: ['需求', '设计', '用户'],
            priority: 'high',
          },
          {
            titleTemplate: '架构设计 Day {n}',
            definition: '进行系统架构设计1.5小时：设计系统整体架构和技术方案。步骤：系统架构设计（40分钟，设计系统分层、模块划分、技术选型）→ 数据库设计（30分钟，设计数据模型、表结构、关系）→ 接口设计（15分钟，设计API接口、数据格式、交互协议）→ 技术方案（5分钟，确定技术栈、开发规范、部署方案）。输出：架构文档、数据库设计、接口文档。',
            estimatedTime: 90,
            tags: ['架构', '设计', '技术'],
            priority: 'high',
          },
          {
            titleTemplate: '环境准备 Day {n}',
            definition: '准备开发环境45分钟：搭建完整的开发环境。步骤：开发环境搭建（20分钟，安装IDE、配置工具、设置环境变量）→ 项目初始化（15分钟，创建项目结构、配置构建工具、初始化版本控制）→ 依赖安装（10分钟，安装项目依赖、配置开发工具、设置代码规范）。确保开发环境完整可用，团队成员环境一致。',
            estimatedTime: 45,
            tags: ['环境', '准备', '工具'],
            priority: 'high',
          },
          {
            titleTemplate: '计划制定 Day {n}',
            definition: '制定开发计划30分钟：分解任务，制定时间表，建立管理流程。步骤：任务分解（15分钟，将项目分解为可执行的任务，估算工作量）→ 时间规划（10分钟，制定时间表、里程碑、关键节点）→ 流程建立（5分钟，建立项目管理流程、协作规范、沟通机制）。输出：开发计划、任务列表、时间表。',
            estimatedTime: 30,
            tags: ['计划', '管理', '协作'],
            priority: 'high',
          },
          {
            titleTemplate: '技术调研 Day {n}',
            definition: '进行技术调研45分钟：调研关键技术、工具和最佳实践。步骤：技术选型（20分钟，对比不同技术方案，评估优缺点）→ 工具调研（15分钟，调研开发工具、测试工具、部署工具）→ 最佳实践（10分钟，学习行业最佳实践、设计模式、开发规范）。输出：技术选型报告、工具清单、最佳实践文档。',
            estimatedTime: 45,
            tags: ['调研', '技术', '选型'],
            priority: 'medium',
          },
        ],
      },
      {
        name: '核心开发期（第3-8周）',
        description: '实现核心功能，推进项目进度\n\n**阶段目标：**\n- 完成核心功能模块开发（每天2-4小时）\n- 保持代码质量和开发规范\n- 及时测试、调试和优化\n- 推进项目进度，按时完成里程碑\n\n**工作重点：**\n- 功能开发：按照设计文档实现功能，编写高质量代码\n- 测试调试：及时测试，发现并修复问题\n- 代码质量：遵循规范，保持代码可维护性\n- 进度管理：跟踪进度，及时调整计划',
        exampleActions: [
          {
            titleTemplate: '功能开发 Day {n}',
            definition: '完成一个功能模块的开发2小时：按照设计文档实现功能。步骤：理解需求（15分钟，阅读设计文档，明确功能要求）→ 设计实现（15分钟，设计代码结构、算法、接口）→ 编码实现（60分钟，编写代码，遵循规范，添加注释）→ 单元测试（20分钟，编写测试用例，确保功能正确）→ 代码审查（10分钟，自我审查，确保质量）。预计完成一个可测试的功能点，记录开发进度和遇到的问题。',
            estimatedTime: 120,
            tags: ['开发', '功能', '实现'],
            priority: 'high',
          },
          {
            titleTemplate: '测试调试 Day {n}',
            definition: '进行测试和调试1小时：测试已开发功能，确保质量。步骤：功能测试（30分钟，测试功能是否按预期工作，记录测试结果）→ 边界测试（15分钟，测试边界条件和异常情况）→ Bug修复（10分钟，发现并修复问题，记录修复过程）→ 回归测试（5分钟，验证修复效果，确保没有引入新问题）。编写测试用例，确保功能稳定可靠。',
            estimatedTime: 60,
            tags: ['测试', '调试', '质量'],
            priority: 'high',
          },
          {
            titleTemplate: '项目复盘 Day {n}',
            definition: '进行项目复盘30分钟：回顾当日进度，优化开发流程。步骤：进度回顾（10分钟，回顾当日完成情况、遇到的问题和解决方案）→ 问题分析（10分钟，分析问题原因，总结经验教训）→ 计划调整（10分钟，更新项目文档、任务列表和进度跟踪，调整后续计划）。建立持续改进机制，提升开发效率。',
            estimatedTime: 30,
            tags: ['复盘', '文档', '优化'],
            priority: 'high',
          },
          {
            titleTemplate: '代码审查 Day {n}',
            definition: '进行代码审查和优化45分钟：提升代码质量。步骤：代码审查（25分钟，审查代码质量、规范、性能、可维护性）→ 代码优化（15分钟，优化代码结构、算法、性能，重构重复代码）→ 规范检查（5分钟，确保代码符合规范，通过静态检查）。确保代码符合规范，提升可维护性和性能。',
            estimatedTime: 45,
            tags: ['审查', '优化', '质量'],
            priority: 'high',
          },
          {
            titleTemplate: '文档编写 Day {n}',
            definition: '编写项目文档30分钟：保持文档与代码同步。步骤：技术文档（15分钟，更新技术文档、API文档、开发文档）→ 代码注释（10分钟，完善代码注释，确保关键逻辑有说明）→ 使用文档（5分钟，更新用户手册、部署文档）。确保文档完整准确，便于团队协作和后续维护。',
            estimatedTime: 30,
            tags: ['文档', '维护', '协作'],
            priority: 'medium',
          },
          {
            titleTemplate: '集成测试 Day {n}',
            definition: '进行集成测试45分钟：测试模块之间的集成。步骤：接口测试（20分钟，测试模块间接口是否正常工作）→ 数据流测试（15分钟，测试数据在各模块间的流转是否正确）→ 集成问题修复（10分钟，修复集成中发现的问题）。确保各模块能够正确协作，系统整体功能正常。',
            estimatedTime: 45,
            tags: ['测试', '集成', '协作'],
            priority: 'medium',
          },
        ],
      },
      {
        name: '测试优化期（第9周+）',
        description: '全面测试，优化完善，准备上线\n\n**阶段目标：**\n- 完成全面测试和调试（每天2-3小时）\n- 优化性能、安全性和用户体验\n- 完善文档和部署方案\n- 准备项目交付和上线\n\n**工作重点：**\n- 全面测试：功能、性能、安全、兼容性\n- 性能优化：代码、数据库、接口、前端\n- 代码重构：提升质量、可维护性\n- 部署准备：环境配置、部署脚本、上线流程',
        exampleActions: [
          {
            titleTemplate: '全面测试 Day {n}',
            definition: '进行全面测试1.5小时：确保系统质量。步骤：功能测试（30分钟，测试所有功能是否正常工作，覆盖主要场景和边界情况）→ 性能测试（20分钟，测试响应时间、并发能力、资源占用）→ 安全测试（20分钟，测试安全漏洞、权限控制、数据安全）→ 兼容性测试（15分钟，测试不同浏览器、设备、系统）→ 问题修复（5分钟，记录并修复发现的问题）。确保系统稳定可靠，满足质量要求。',
            estimatedTime: 90,
            tags: ['测试', '质量', '全面'],
            priority: 'high',
          },
          {
            titleTemplate: '性能优化 Day {n}',
            definition: '进行性能优化1小时：提升系统性能。步骤：性能分析（20分钟，分析性能瓶颈：代码、数据库、接口、前端）→ 代码优化（20分钟，优化算法、减少计算、优化循环）→ 数据库优化（15分钟，优化查询、索引、连接池）→ 接口优化（5分钟，优化接口响应、缓存策略）。提升系统性能和用户体验，记录优化效果。',
            estimatedTime: 60,
            tags: ['优化', '性能', '体验'],
            priority: 'high',
          },
          {
            titleTemplate: '代码重构 Day {n}',
            definition: '进行代码优化和重构1小时：提升代码质量。步骤：代码分析（20分钟，识别重复代码、复杂逻辑、设计问题）→ 重构实施（30分钟，重构代码结构、提取公共方法、优化设计）→ 测试验证（10分钟，确保重构后功能正常，没有引入新问题）。提升代码质量、可维护性和可读性。',
            estimatedTime: 60,
            tags: ['重构', '优化', '质量'],
            priority: 'high',
          },
          {
            titleTemplate: '文档完善 Day {n}',
            definition: '完善项目文档45分钟：确保文档完整准确。步骤：用户文档（15分钟，更新用户手册、操作指南、FAQ）→ 技术文档（15分钟，更新技术文档、API文档、架构文档）→ 部署文档（10分钟，更新部署文档、运维文档、故障处理文档）→ 文档审查（5分钟，检查文档完整性、准确性、易读性）。确保文档完整准确，便于后续维护和使用。',
            estimatedTime: 45,
            tags: ['文档', '完善', '维护'],
            priority: 'high',
          },
          {
            titleTemplate: '部署准备 Day {n}',
            definition: '准备项目部署1小时：确保顺利上线。步骤：环境配置（25分钟，配置生产环境、服务器、数据库、域名）→ 部署脚本（20分钟，编写部署脚本、自动化流程、回滚方案）→ 部署测试（10分钟，在测试环境进行部署测试，验证部署流程）→ 上线检查（5分钟，检查上线清单，确保所有准备工作完成）。确保项目可以顺利上线，有完善的部署和回滚方案。',
            estimatedTime: 60,
            tags: ['部署', '上线', '运维'],
            priority: 'high',
          },
          {
            titleTemplate: '上线验证 Day {n}',
            definition: '进行上线验证和监控45分钟：确保上线成功。步骤：上线执行（20分钟，执行上线流程，部署到生产环境）→ 功能验证（15分钟，验证关键功能是否正常工作）→ 监控检查（10分钟，检查系统监控、日志、性能指标）。确保上线成功，系统正常运行，有问题及时处理。',
            estimatedTime: 45,
            tags: ['上线', '验证', '监控'],
            priority: 'high',
          },
        ],
      },
    ],
    // 向后兼容：取第一个阶段
    phase: undefined as any,
  },
}

/**
 * 获取指定类别的模板
 */
export function getTemplate(category: TemplateCategory): GoalTemplate {
  const template = GOAL_TEMPLATES[category]
  // 向后兼容：如果只有 phases，设置 phase 为第一个阶段
  if (template.phases && template.phases.length > 0 && !template.phase) {
    template.phase = template.phases[0]
  }
  return template
}

